name: Auto Update Song List

on:
  schedule:
    - cron: '0 * * * *' # æ¯å°æ—¶æ‰§è¡Œ
  workflow_dispatch: # ä¿ç•™æ‰‹åŠ¨è§¦å‘

# å…¨å±€æƒé™å£°æ˜
permissions:
  contents: write

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - name: æ‹‰å–ä»“åº“ä»£ç 
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: é…ç½®Node.jsç¯å¢ƒ
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: è¿è¡Œæ­Œå•æ›´æ–°è„šæœ¬
        run: node scripts/update-songs.js

      - name: æäº¤å¹¶æ¨é€æ›´æ–°ï¼ˆé›¶å†²çªæ–¹æ¡ˆï¼‰
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          branch: main
          directory: data # åªæäº¤dataæ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œé¿å…å…¶ä»–æ–‡ä»¶å†²çª
          force: false
          message: "ğŸ¤– è‡ªåŠ¨æ›´æ–°æ­Œå•æ•°æ®"
