<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­Œæ›²ç»Ÿè®¡ - å‡ºåœºé¢‘ç‡ä¸VTuberæ­Œå•</title>
    <style>
        /* æ ·å¼çœç•¥ï¼Œç›´æ¥ä½¿ç”¨åŸæœ‰æ ·å¼ */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "PingFang SC", "Microsoft YaHei", sans-serif; 
            max-width: 1200px; margin: 0 auto; padding: 30px 20px; 
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); min-height: 100vh;
        }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 10px; font-size: 28px; font-weight: 700; }
        .sub-header { text-align: center; color: #6c757d; margin-bottom: 25px; font-size: 14px; }
        .nav-link { color: #00a1d6; text-decoration: none; font-weight: 600; }
        .tabs-container { display: flex; justify-content: center; gap: 12px; margin-bottom: 25px; flex-wrap: wrap; }
        .tab-btn { padding: 12px 28px; border: none; border-radius: 25px; font-size: 15px; font-weight: 600; cursor: pointer; background: white; color: #495057; box-shadow: 0 2px 8px rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .tab-btn.active { background: linear-gradient(135deg, #00a1d6 0%, #00c6ff 100%); color: white; }
        .filter-search-container { display: flex; flex-direction: column; gap: 18px; margin-bottom: 25px; }
        .filter-bar { display: flex; gap: 10px; flex-wrap: wrap; padding: 15px 20px; background: white; border-radius: 12px; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .filter-label { font-size: 14px; color: #495057; font-weight: 600; }
        .filter-btn { padding: 7px 16px; border: 1px solid #e9ecef; border-radius: 20px; background: #f8f9fa; cursor: pointer; font-size: 14px; color: #495057; }
        .filter-btn:hover { border-color: #00a1d6; color: #00a1d6; }
        .filter-btn.active { background: linear-gradient(135deg, #00a1d6 0%, #00c6ff 100%); color: white; }
        .search-container { display: flex; gap: 12px; flex-wrap: wrap; }
        #search-input { flex: 1; min-width: 250px; padding: 16px 20px; font-size: 16px; border: 2px solid #e9ecef; border-radius: 12px; outline: none; background: white; }
        #search-btn { padding: 0 32px; background: linear-gradient(135deg, #00a1d6 0%, #00c6ff 100%); color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; }
        .stats-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .stats-text { font-size: 13px; color: #6c757d; font-weight: 500; }
        .progress-msg { text-align: center; color: #495057; padding: 60px 20px; font-size: 16px; font-weight: 500; }
        .empty-msg { text-align: center; color: #6c757d; padding: 60px 20px; font-size: 16px; display: none; font-weight: 500; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .toggle-btn { padding: 6px 14px; border: 1px solid #e9ecef; border-radius: 8px; background: white; color: #6c757d; font-size: 13px; cursor: pointer; width: 100%; margin-top: 10px; }
        .toggle-btn:hover { border-color: #00a1d6; color: #00a1d6; }
        .perf-grid-small { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 10px; padding-top: 10px; border-top: 1px dashed #f1f3f5; }
        .perf-link-small { padding: 4px 10px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 6px; font-size: 12px; color: #495057; text-decoration: none; }
        .perf-link-small:hover { border-color: #00a1d6; color: #00a1d6; }
        .hidden { display: none; }
        #rank-list { list-style: none; padding: 0; margin-bottom: 35px; }
        .rank-item { padding: 22px 25px; margin-bottom: 15px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
        .rank-badge { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 14px; }
        .rank-1 { background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); color: #8b6914; }
        .rank-2 { background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%); color: #5a5a5a; }
        .rank-3 { background: linear-gradient(135deg, #cd7f32 0%, #e9a66a 100%); color: #5c3a1a; }
        .rank-other { background: #f8f9fa; color: #6c757d; border: 1px solid #e9ecef; }
        .song-title-large { font-size: 20px; font-weight: 800; color: #2c3e50; }
        .info-chip { display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px; border-radius: 12px; font-size: 13px; font-weight: 500; margin-top: 6px; }
        .chip-artist { background: #e3f2fd; color: #1565c0; }
        .count-badge { padding: 8px 18px; border-radius: 20px; font-size: 16px; font-weight: 800; background: linear-gradient(135deg, #6f42c1 0%, #8a6edb 100%); color: white; }
        .perf-link { padding: 5px 12px; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 6px; font-size: 12px; color: #495057; text-decoration: none; }
        .perf-link:hover { border-color: #00a1d6; color: #00a1d6; }
        .perf-hidden { display: none; }
        .group-card { margin-bottom: 30px; background: white; border-radius: 16px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .group-header { padding: 18px 25px; display: flex; justify-content: space-between; align-items: center; }
        .group-header.vtuber { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .group-header.artist { background: linear-gradient(135deg, #00a1d6 0%, #00c6ff 100%); color: white; }
        .group-name { font-size: 20px; font-weight: 800; }
        .group-count { font-size: 13px; opacity: 0.95; background: rgba(255,255,255,0.2); padding: 5px 12px; border-radius: 12px; }
        .group-songs { padding: 20px 25px; }
        .song-item-row { display: flex; justify-content: space-between; align-items: flex-start; padding: 12px 0; border-bottom: 1px dashed #f1f3f5; flex-wrap: wrap; gap: 10px; }
        .song-title-main { font-weight: 600; color: #2c3e50; font-size: 15px; margin-bottom: 4px; }
        .song-original-artist { font-size: 12px; color: #868e96; }
        .count-clickable { font-size: 12px; color: #495057; background: #f8f9fa; padding: 4px 10px; border-radius: 8px; cursor: pointer; border: 1px solid #e9ecef; }
        .count-clickable:hover { border-color: #6f42c1; color: #6f42c1; }
        .pagination { display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: 30px; padding: 20px; }
        .page-btn { padding: 10px 16px; border: 1px solid #e9ecef; border-radius: 8px; background: white; cursor: pointer; font-size: 14px; color: #495057; }
        .page-btn.active { background: linear-gradient(135deg, #00a1d6 0%, #00c6ff 100%); color: white; border-color: transparent; }
    </style>
</head>
<body>
    <h1>ğŸ“Š æ­Œæ›²ç»Ÿè®¡ä¸åˆ†æ</h1>
    <div class="sub-header">
        æŸ¥çœ‹æ­Œæ›²å‡ºåœºé¢‘ç‡ã€VTuberåˆé›†æ­Œå•ä¸æ­Œæ‰‹åˆ†ç±» | <a href="index.html" class="nav-link">è¿”å›æ­Œæ›²æŸ¥è¯¢ç«™</a>
    </div>

    <div class="tabs-container">
        <button class="tab-btn active" data-tab="rank">ğŸ† æ­Œæ›²æ€»å‡ºåœºæ’è¡Œ</button>
        <button class="tab-btn" data-tab="vtuber-source">ğŸ¤ æŒ‰VTuberåˆ†ç±»</button>
        <button class="tab-btn" data-tab="artist">ğŸ™ï¸ æŒ‰æ­Œæ‰‹åˆ†ç±»</button>
    </div>

    <div class="filter-search-container">
        <div class="filter-bar" id="filter-bar"></div>
        <div class="search-container">
            <input type="text" id="search-input" placeholder="è¾“å…¥æ­Œåã€æ­Œæ‰‹ã€åˆé›†æœç´¢...">
            <button id="search-btn">ğŸ” æœç´¢</button>
        </div>
    </div>

    <div class="stats-bar"><div class="stats-text" id="summary-text">åŠ è½½ä¸­...</div></div>
    <div class="progress-msg" id="progress-msg">ğŸ“¥ æ­£åœ¨åŠ è½½å¹¶ç»Ÿè®¡æ•°æ®...</div>
    <div class="empty-msg" id="empty-msg">âŒ æš‚æ— æ•°æ®</div>

    <div id="tab-rank" class="tab-content active"><ul id="rank-list"></ul><div class="pagination" id="pagination-rank"></div></div>
    <div id="tab-vtuber-source" class="tab-content"><ul id="vtuber-source-list"></ul></div>
    <div id="tab-artist" class="tab-content"><ul id="artist-list"></ul></div>

    <!-- å¼•å…¥å…¬å…±é€»è¾‘ -->
    <script src="common.js"></script>
    <script>
        window.SONG_DATA = [];
        let originalData = [];
        let fileNames = [];
        let FILE_TO_ALIAS = {};
        let activeTab = 'rank';
        let activeFilter = 'all';
        let searchKeyword = '';
        const PAGE_SIZE = 30;
        let currentRankPage = 1;

        // ========== æ•°æ®èšåˆ (ä½¿ç”¨ extractCore ä½œä¸º Key) ==========
        function aggregateBySong(data) {
            const map = new Map();
            data.forEach(item => {
                // ğŸ”§ ä½¿ç”¨æ ¸å¿ƒä¸»ä½“ç”Ÿæˆ Key
                const keyTitle = extractCore(item.title || 'æœªçŸ¥æ­Œæ›²');
                const keyArtist = extractCore(item.artist || '');
                const key = `${keyTitle}|${keyArtist}`;

                if (!map.has(key)) {
                    map.set(key, {
                        title: item.title, // æ˜¾ç¤ºç”¨åŸå
                        artist: item.artist,
                        originalArtist: item.originalArtist || '',
                        count: 0,
                        performances: []
                    });
                }
                const entry = map.get(key);
                entry.count++;
                entry.performances.push({ link: item.link, collection: item.collection || 'æœªçŸ¥åˆé›†' });
            });
            const arr = Array.from(map.values());
            arr.sort((a, b) => b.count - a.count);
            return arr;
        }

        function aggregateByVtuberSource(data) {
            const map = new Map();
            data.forEach(item => {
                const sourceFile = item.source || 'æœªçŸ¥æ¥æº';
                const sourceKey = sourceFile.replace('.js', '');
                const vtuberName = FILE_TO_ALIAS[sourceKey] || sourceKey;

                if (!map.has(sourceKey)) {
                    map.set(sourceKey, { name: vtuberName, songs: new Map() });
                }
                const vtuberEntry = map.get(sourceKey);
                
                // ğŸ”§ ä½¿ç”¨æ ¸å¿ƒä¸»ä½“
                const songKey = extractCore(item.title || 'æœªçŸ¥æ­Œæ›²');
                if (!vtuberEntry.songs.has(songKey)) {
                    vtuberEntry.songs.set(songKey, {
                        title: item.title,
                        originalArtist: item.originalArtist || '',
                        artist: item.artist || '',
                        count: 0,
                        links: []
                    });
                }
                const songEntry = vtuberEntry.songs.get(songKey);
                songEntry.count++;
                if (item.link) songEntry.links.push({ link: item.link, collection: item.collection || 'æœªçŸ¥åˆé›†' });
            });

            const result = Array.from(map.values());
            result.forEach(v => {
                v.songs = Array.from(v.songs.values());
                v.songs.sort((a, b) => b.count - a.count);
                v.totalCount = v.songs.reduce((acc, s) => acc + s.count, 0);
                v.uniqueCount = v.songs.length;
            });
            result.sort((a, b) => b.totalCount - a.totalCount);
            return result;
        }

        function aggregateByArtist(data) {
            const map = new Map();
            data.forEach(item => {
                const artist = item.artist || '';
                if (!isValidArtist(artist)) return;

                // ğŸ”§ ä½¿ç”¨æ ¸å¿ƒä¸»ä½“
                const key = extractCore(artist);
                if (!map.has(key)) {
                    map.set(key, { name: artist, songs: new Map() }); // æ˜¾ç¤ºç”¨ç¬¬ä¸€ä¸ªé‡åˆ°çš„åå­—
                }
                const artistEntry = map.get(key);
                
                const songKey = extractCore(item.title || 'æœªçŸ¥æ­Œæ›²');
                if (!artistEntry.songs.has(songKey)) {
                    artistEntry.songs.set(songKey, {
                        title: item.title,
                        originalArtist: item.originalArtist || '',
                        count: 0,
                        links: []
                    });
                }
                const songEntry = artistEntry.songs.get(songKey);
                songEntry.count++;
                if (item.link) songEntry.links.push({ link: item.link, collection: item.collection || 'æœªçŸ¥åˆé›†' });
            });

            const result = Array.from(map.values());
            result.forEach(v => {
                v.songs = Array.from(v.songs.values());
                v.songs.sort((a, b) => b.count - a.count);
                v.totalCount = v.songs.reduce((acc, s) => acc + s.count, 0);
                v.uniqueCount = v.songs.length;
            });
            result.sort((a, b) => b.totalCount - a.totalCount);
            return result;
        }

        function getFilteredData() {
            let data = [...originalData];
            if (activeFilter !== 'all') {
                data = data.filter(item => item.source === activeFilter);
            }
            if (searchKeyword) {
                const kw = normalizeString(searchKeyword);
                data = data.filter(item => {
                    const t = normalizeString(item.title || '');
                    const a = normalizeString(item.artist || '');
                    const c = normalizeString(item.collection || '');
                    return t.includes(kw) || a.includes(kw) || c.includes(kw);
                });
            }
            return data;
        }

        function uniqueId() { return Math.random().toString(36).substr(2, 9); }

        function generateFilterButtons() {
            const filterBar = document.getElementById('filter-bar');
            filterBar.innerHTML = '<span class="filter-label">ğŸ” ç­›é€‰VTuber/æ¥æºï¼š</span>';
            const allBtn = document.createElement('button');
            allBtn.className = `filter-btn ${activeFilter === 'all' ? 'active' : ''}`;
            allBtn.textContent = 'å…¨éƒ¨';
            allBtn.onclick = () => { activeFilter = 'all'; currentRankPage = 1; updateAllViews(); };
            filterBar.appendChild(allBtn);
            
            const spacer = document.createElement('span');
            spacer.style.width = '10px';
            filterBar.appendChild(spacer);
            
            fileNames.forEach(fileName => {
                const fileBase = fileName.replace('.js', '');
                const btnText = FILE_TO_ALIAS[fileBase] || fileBase;
                const btn = document.createElement('button');
                btn.className = `filter-btn ${activeFilter === fileName ? 'active' : ''}`;
                btn.textContent = btnText;
                btn.onclick = () => { activeFilter = fileName; currentRankPage = 1; updateAllViews(); };
                filterBar.appendChild(btn);
            });
        }

        function renderRankList(data) {
            const listEl = document.getElementById('rank-list');
            const aggData = aggregateBySong(data);
            document.getElementById('summary-text').textContent = `ğŸ“Š å…±ç»Ÿè®¡ ${aggData.length} é¦–ä¸åŒçš„â€œæ­Œæ›²+æ­Œæ‰‹â€ç»„åˆ`;

            const start = (currentRankPage - 1) * PAGE_SIZE;
            const pageData = aggData.slice(start, start + PAGE_SIZE);

            if (pageData.length === 0) {
                document.getElementById('empty-msg').style.display = 'block';
                listEl.innerHTML = '';
            } else {
                document.getElementById('empty-msg').style.display = 'none';
                listEl.innerHTML = '';
                pageData.forEach((item, idx) => {
                    const globalRank = start + idx + 1;
                    const rankClass = globalRank === 1 ? 'rank-1' : (globalRank === 2 ? 'rank-2' : (globalRank === 3 ? 'rank-3' : 'rank-other'));
                    const id = uniqueId();
                    const li = document.createElement('li');
                    li.className = 'rank-item';
                    li.innerHTML = `
                        <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:20px;flex-wrap:wrap;margin-bottom:12px;">
                            <div style="flex:1;min-width:250px;">
                                <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
                                    <div class="rank-badge ${rankClass}">${globalRank}</div>
                                    <div>
                                        <div class="song-title-large">${item.title}</div>
                                        <span class="info-chip chip-artist">ğŸ¤ ${isValidArtist(item.artist) ? item.artist : 'æ— æ­Œæ‰‹ä¿¡æ¯'}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="count-badge">${item.count} æ¬¡</div>
                        </div>
                    `;
                    listEl.appendChild(li);
                });
            }
            renderPagination(aggData.length);
        }

        function renderGroupList(data, listElId, type) {
            const listEl = document.getElementById(listElId);
            if (data.length === 0) { document.getElementById('empty-msg').style.display = 'block'; listEl.innerHTML = ''; return; }
            document.getElementById('empty-msg').style.display = 'none';
            listEl.innerHTML = '';

            data.forEach(group => {
                const groupId = uniqueId();
                const showSongs = group.songs.slice(0, 3);
                const hiddenSongs = group.songs.slice(3);
                const hasMore = hiddenSongs.length > 0;

                const renderRow = (song) => {
                    const songId = uniqueId();
                    return `
                        <div class="song-item-row">
                            <div class="song-info-left">
                                <div class="song-title-main">${song.title}</div>
                                ${song.originalArtist ? `<div class="song-original-artist">ğŸ“ åŸå”±: ${song.originalArtist}</div>` : ''}
                            </div>
                            <div class="song-meta-right">
                                <span class="count-clickable">${type === 'vtuber' ? 'æ”¶å½•' : 'æ¼”å”±'} ${song.count} æ¬¡</span>
                                <a href="${song.links[0]?.link || '#'}" target="_blank" class="perf-link-small">ç›´è¾¾</a>
                            </div>
                        </div>
                    `;
                };

                const li = document.createElement('li');
                li.className = 'group-card';
                li.innerHTML = `
                    <div class="group-header ${type}">
                        <div class="group-name">${type === 'vtuber' ? 'ğŸ™ï¸' : 'ğŸ¤'} ${group.name}</div>
                        <div class="group-count">æ€»è®¡ ${group.totalCount} é¦–ï¼ˆå»é‡ ${group.uniqueCount} é¦–ï¼‰</div>
                    </div>
                    <div class="group-songs">
                        ${showSongs.map(s => renderRow(s)).join('')}
                        ${hasMore ? `<div id="more-${groupId}" class="hidden">${hiddenSongs.map(s => renderRow(s)).join('')}</div>` : ''}
                        ${hasMore ? `<button class="toggle-btn" onclick="document.getElementById('more-${groupId}').classList.toggle('hidden'); this.textContent = this.textContent.includes('å±•å¼€') ? 'æ”¶èµ·' : 'å±•å¼€å…¨éƒ¨ ${group.songs.length} é¦–'">å±•å¼€å…¨éƒ¨ ${group.songs.length} é¦–</button>` : ''}
                    </div>
                `;
                listEl.appendChild(li);
            });
        }

        function renderVtuberSourceList(data) {
            const aggData = aggregateByVtuberSource(data);
            document.getElementById('summary-text').textContent = `ğŸ¤ å…±æ”¶å½• ${aggData.length} ä½VTuberçš„åˆé›†æ­Œå•`;
            renderGroupList(aggData, 'vtuber-source-list', 'vtuber');
        }

        function renderArtistList(data) {
            const aggData = aggregateByArtist(data);
            document.getElementById('summary-text').textContent = `ğŸ™ï¸ å…±æ”¶å½• ${aggData.length} ä½æ­Œæ‰‹çš„æ­Œå•`;
            renderGroupList(aggData, 'artist-list', 'artist');
        }

        function renderPagination(total) {
            const el = document.getElementById('pagination-rank');
            el.innerHTML = '';
            const totalPages = Math.ceil(total / PAGE_SIZE);
            if (totalPages <= 1) return;
            const addBtn = (text, cls, onClick) => {
                const btn = document.createElement('button');
                btn.className = `page-btn ${cls || ''}`;
                btn.textContent = text;
                btn.onclick = onClick;
                el.appendChild(btn);
            };
            addBtn('ä¸Šä¸€é¡µ', currentRankPage === 1 ? 'disabled' : '', () => { if(currentRankPage>1) { currentRankPage--; updateAllViews(); }});
            for(let i=Math.max(1, currentRankPage-3); i<=Math.min(totalPages, currentRankPage+3); i++) {
                addBtn(i, i === currentRankPage ? 'active' : '', () => { currentRankPage = i; updateAllViews(); });
            }
            addBtn('ä¸‹ä¸€é¡µ', currentRankPage === totalPages ? 'disabled' : '', () => { if(currentRankPage<totalPages) { currentRankPage++; updateAllViews(); }});
        }

        function updateAllViews() {
            generateFilterButtons();
            const data = getFilteredData();
            if (data.length === 0) {
                document.getElementById('empty-msg').style.display = 'block';
                document.getElementById('rank-list').innerHTML = '';
                document.getElementById('vtuber-source-list').innerHTML = '';
                document.getElementById('artist-list').innerHTML = '';
                document.getElementById('summary-text').textContent = 'ğŸ˜” å½“å‰ç­›é€‰ä¸‹æ²¡æœ‰æ•°æ®';
            } else {
                document.getElementById('empty-msg').style.display = 'none';
                if (activeTab === 'rank') renderRankList(data);
                else if (activeTab === 'vtuber-source') renderVtuberSourceList(data);
                else if (activeTab === 'artist') renderArtistList(data);
            }
        }

        function switchTab(tab) {
            activeTab = tab;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelector(`.tab-btn[data-tab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            updateAllViews();
        }

        function loadScriptsParallel(fileList) {
            const progressMsg = document.getElementById('progress-msg');
            let loadedCount = 0;
            const promises = fileList.map(fileName => {
                return new Promise((resolve) => {
                    const script = document.createElement('script');
                    script.src = `data/${fileName}`;
                    script.onload = () => {
                        const newDataCount = window.SONG_DATA.length - originalData.length;
                        if (newDataCount > 0) {
                            const newData = window.SONG_DATA.slice(-newDataCount);
                            newData.forEach(item => item.source = fileName);
                            originalData = [...window.SONG_DATA];
                        }
                        loadedCount++;
                        progressMsg.textContent = `ğŸ“¥ åŠ è½½æ•°æ® (${loadedCount}/${fileList.length})...`;
                        resolve();
                    };
                    script.onerror = () => resolve();
                    document.body.appendChild(script);
                });
            });
            return Promise.all(promises);
        }

        async function bootstrap() {
            try {
                const res = await fetch('data/index.json');
                const config = await res.json();
                fileNames.push(...(config.files || []));
                FILE_TO_ALIAS = config.fileToAlias || {};

                await loadScriptsParallel(fileNames);
                document.getElementById('progress-msg').style.display = 'none';
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', () => switchTab(btn.dataset.tab));
                });

                const searchInput = document.getElementById('search-input');
                const searchBtn = document.getElementById('search-btn');
                const doSearch = () => {
                    searchKeyword = searchInput.value.trim();
                    currentRankPage = 1;
                    updateAllViews();
                };
                searchBtn.addEventListener('click', doSearch);
                searchInput.addEventListener('keydown', (e) => { if (e.key === 'Enter') doSearch(); });

                generateFilterButtons();
                updateAllViews();
            } catch (err) {
                console.error(err);
                document.getElementById('progress-msg').textContent = `âŒ åŠ è½½å¤±è´¥: ${err.message}`;
            }
        }
        document.addEventListener('DOMContentLoaded', bootstrap);
    </script>
</body>
</html>
